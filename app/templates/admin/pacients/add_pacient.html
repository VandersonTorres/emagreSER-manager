{% extends "base.html" %}
{% block content %}
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">
                    <strong>{{ message }}</strong>
                </div>
            {% endfor %}
            {% set _ = session.pop('_flashes', None) %}
        {% endif %}
    {% endwith %}

    <h2>CADASTRAR PACIENTE</h2>
    <form method="POST" action="{{ url_for('admin.add_pacient') }}">
        <h3>Dados pessoais:</h3>
        <label for="name">Nome:</label>
        <input type="text" name="name" required>
        <br>
        <label for="gender">Sexo:</label>
        <select name="gender" required>
            <option value="">Selecione</option>
            <option value="masculino">Masculino</option>
            <option value="feminino">Feminino</option>
        </select>
        <br>
        <label for="birth_date">Data de nascimento:</label>
        <input type="date" name="birth_date" required>
        <br>
        <label for="cpf">CPF:</label>
        <input type="text" id="cpf" name="cpf" pattern="\d{3}\.\d{3}\.\d{3}-\d{2}" maxlength="14" placeholder="000.000.000-00" required>
        <br>
        <label for="phone">Número de telefone:</label>
        <input type="text" id="phone" name="phone" pattern="\(\d{2}\) \d{4,5}-\d{4}" placeholder="(00) 00000-0000" required>
        <br>
        <label for="email">E-mail:</label>
        <input type="text" name="email" required>
        <br><br>

        <h3>História Clínica:</h3>
        <label for="medication">Faz uso de medicação?</label>
        <select name="medication" id="medication" required onchange="toggleMedicationsInput(this)">
            <option value="">Selecione</option>
            <option value="não">Não</option>
            <option value="sim">Sim</option>
        </select>
        <input type="text" id="medications_details" name="medications_details" placeholder="Se sim, quais?" style="display: none;">
        <br>
        <label for="intestine">Funcionamento intestino:</label>
        <input type="number" name="intestine" min="0" required> vezes por semana
        <br>
        <label for="allergies">Alergias / intolerâncias?</label>
        <select name="allergies" id="allergies" required onchange="toggleAllergiesInput(this)">
            <option value="">Selecione</option>
            <option value="não">Não</option>
            <option value="sim">Sim</option>
        </select>
        <input type="text" id="allergies_details" name="allergies_details" placeholder="Se sim, quais?" style="display: none;">
        <br>
        <label for="water">Quantos litros de água bebe por dia?</label>
        <input type="number" name="water" min="0" step="0.1" required> litros
        <br>
        <label for="heartburn">Azia / Refluxo:</label>
        <select name="heartburn" required>
            <option value="">Selecione</option>
            <option value="não">Não</option>
            <option value="sim">Sim</option>
        </select>
        <br><br>

        <h3>História Comportamental</h3>
        <label for="physical_activities">Faz atividade física?</label>
        <select name="physical_activities" id="physical_activities" required onchange="togglePhysicalInput(this)">
            <option value="">Selecione</option>
            <option value="não">Não</option>
            <option value="sim">Sim</option>
        </select>
        <input type="text" id="physical_details" name="physical_details" placeholder="Se sim, quais?" style="display: none;">
        <br>
        <label for="hours">Horário das atividades:</label>
        <input type="time" name="hours">
        <br>
        <label for="frequency">Frequência das atividades:</label>
        <input type="number" name="frequency" min="0"> vezes por semana
        <br>
        <label for="objective">Objetivo da consulta:</label>
        <input type="text" name="objective" required>
        <br><br>

        <script>
            function toggleMedicationsInput(select) {
                document.getElementById('medications_details').style.display = select.value === "sim" ? "inline" : "none";
            }
            function toggleAllergiesInput(select) {
                document.getElementById('allergies_details').style.display = select.value === "sim" ? "inline" : "none";
            }
            function togglePhysicalInput(select) {
                document.getElementById('physical_details').style.display = select.value === "sim" ? "inline" : "none";
            }
        </script>
        <button type="submit">Cadastrar Paciente</button>
    </form>
{% endblock %}
