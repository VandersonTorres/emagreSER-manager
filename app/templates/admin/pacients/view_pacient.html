{% extends "base.html" %}

{% block content %}
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">
                    <strong>{{ message }}</strong>
                </div>
            {% endfor %}
            {% set _ = session.pop("_flashes", None) %}
        {% endif %}
    {% endwith %}
    <h2>Hist√≥rico do Paciente</h2>

    {% if pacient %}
        <div class="pacient-card">
            <p><strong>Nome:</strong> {{ pacient.name }}</p>
            <p><strong>Sexo:</strong> {{ pacient.gender }}</p>
            <p><strong>Data de Nascimento:</strong> {{ pacient.birth_date }}</p>
            <p><strong>CPF:</strong> {{ pacient.cpf }}</p>
            <p><strong>N√∫mero de telefone:</strong> {{ pacient.tel_number }}</p>
            <p><strong>E-mail:</strong> {{ pacient.email }}</p>
            <br>

            <h3>Avalia√ß√£o Antropom√©trica:</h3>
            {% if pacient.anthropometric_evaluations|length > 0 %}
                <table border="1">
                    <thead>
                        <tr>
                            <th>Data Avalia√ß√£o</th>
                            <th>Nome da √öltima Guia</th>
                            <th>Idade</th>
                            <th>Altura</th>
                            <th>Peso</th>
                            <th>Evolu√ß√£o</th>
                            <th>Peso Max</th>
                            <th>Peso Ideal</th>
                            <th>Peso M√≠nimo</th>
                            <th>IMC</th>
                            <th>Classifica√ß√£o Nutricional</th>
                            <th>Grau Atv. F√≠sica</th>
                            <th>Press√£o Arterial</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for evaluation in pacient.anthropometric_evaluations %}
                            <tr>
                                <td>{{ evaluation.data_avaliacao }}</td>
                                <td>{{ evaluation.ultima_guia }}</td>
                                <td>{{ evaluation.idade }}</td>
                                <td>{{ evaluation.altura }}</td>
                                <td>{{ evaluation.peso }}</td>
                                <td>{{ evaluation.evolucao }}</td>
                                <td>{{ evaluation.p_max }}</td>
                                <td>{{ evaluation.p_ide }}</td>
                                <td>{{ evaluation.p_min }}</td>
                                <td>{{ evaluation.imc }}</td>
                                <td>{{ evaluation.nutri_class }}</td>
                                <td>{{ evaluation.grau_atv_fisica }}</td>
                                <td>{{ evaluation.pa }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p>N√£o h√° avalia√ß√µes antropom√©tricas registradas.</p>
                <a href="{{ url_for('admin.add_anthro', pacient_id=pacient.id) }}">Adicionar Avalia√ß√£o Antropom√©trica</a>

            {% endif %}

            <h3>Pregas Cut√¢neas:</h3>
            {% if pacient.skinfolds|length > 0 %}
                <table border="1">
                    <thead>
                        <tr>
                            <th>Data Medi√ß√£o</th>
                            <th>Tricipital</th>
                            <th>Bicipital</th>
                            <th>Subsc√°pula</th>
                            <th>Tor√°cica</th>
                            <th>Axilar M√©dia</th>
                            <th>Supra Il√≠aca</th>
                            <th>Abdominal</th>
                            <th>Coxa</th>
                            <th>Panturrilha</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for fold in pacient.skinfolds %}
                            <tr>
                                <td>{{ fold.data_medicao }}</td>
                                <td>{{ fold.triciptal }}</td>
                                <td>{{ fold.bicipital }}</td>
                                <td>{{ fold.subscapula }}</td>
                                <td>{{ fold.toracica }}</td>
                                <td>{{ fold.axilar }}</td>
                                <td>{{ fold.supra }}</td>
                                <td>{{ fold.abdominal }}</td>
                                <td>{{ fold.coxa }}</td>
                                <td>{{ fold.panturrilha }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p>N√£o h√° registros de pregas cut√¢neas.</p>
                <a href="{{ url_for('admin.add_skinfold', pacient_id=pacient.id) }}">Adicionar Pregas Cut√¢neas</a>
            {% endif %}

            <br><br>
            <hr>

            <h3>Mais detalhes sobre {{ pacient.name }}</h3>
            <br>
            <h4>Hist√≥ria Cl√≠nica:</h4>
            <p><strong>Faz uso de medica√ß√£o?</strong> {{ pacient.medication }}</p>
            {% if pacient.medication == 'sim' %}
                <p><strong>Quais?</strong> {{ pacient.medications_details }}</p>
            {% endif %}
            <p><strong>Funcionamento intestinal:</strong> {{ pacient.intestine }} vezes por semana</p>
            <p><strong>Alergias / Intoler√¢ncias?</strong> {{ pacient.allergies }}</p>
            {% if pacient.allergies == 'sim' %}
                <p><strong>Quais?</strong> {{ pacient.allergies_details }}</p>
            {% endif %}
            <p><strong>Consumo de √°gua:</strong> {{ pacient.water }} litros/dia</p>
            <p><strong>Azia / Refluxo:</strong> {{ pacient.heartburn }}</p>
            <br>

            <h4>Hist√≥ria Comportamental:</h4>
            <p><strong>Faz atividade f√≠sica?</strong> {{ pacient.physical_activities }}</p>
            {% if pacient.physical_activities == 'sim' %}
                <p><strong>Quais?</strong> {{ pacient.physical_details }}</p>
            {% endif %}
            <p><strong>Hor√°rio das atividades:</strong> {{ pacient.hours }}</p>
            <p><strong>Frequ√™ncia das atividades:</strong> {{ pacient.frequency }} vezes por semana</p>
            <p><strong>Objetivo da consulta:</strong> {{ pacient.objective }}</p>
            <br>
            <hr>
        </div>
    {% else %}
        <p>Nenhum paciente cadastrado.</p>
    {% endif %}
    <a href="{{ url_for('admin.list_pacients') }}">üîô Voltar</a>
    &nbsp;
    <a href="{{ url_for('admin.edit_pacient', id=pacient.id) }}">Editar</a>
    &nbsp;
    <a href="{{ url_for('admin.delete_pacient', id=pacient.id) }}">Remover</a>
{% endblock %}
